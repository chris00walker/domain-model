@startuml efi_context_map

' Enhanced diagram with complete integration points
skinparam component {
    BackgroundColor #dbeafe
    BackgroundColor<<Core>> #fee2e2
    BackgroundColor<<Strategic>> #fef3c7
    BackgroundColor<<Integration>> #e0f2fe
    BackgroundColor<<External>> #f0fdf4
    ArrowColor #666666
    BorderColor #666666
    FontSize 12
}

title Elias Food Imports - Bounded Context Map

legend top left
  | Color | Type | Description |
  |<#fee2e2>|<#fee2e2> Core |<#fee2e2> Critical |
  |<#fef3c7>|<#fef3c7> Strategic |<#fef3c7> Competitive |
  |<#dbeafe>|<#dbeafe> Supporting |<#dbeafe> Operational |
  |<#e0f2fe>|<#e0f2fe> Integration |<#e0f2fe> Cross-cutting |
  |<#f0fdf4>|<#f0fdf4> External |<#f0fdf4> Third-party |
  |<#ffffff>|<#ffffff> ACL |<#ffffff> Anti-Corruption Layer |
endlegend

' Define components
rectangle "üõí CUSTOMER INTERFACE LAYER" {
  [Shopping Cart] as ShoppingCart <<Supporting>>
  note right of ShoppingCart
    ‚Ä¢ Product selection
    ‚Ä¢ Availability check
    ‚Ä¢ Price calculation
  end note

  [Order Management] as OrderMgmt <<Core>>
  note right of OrderMgmt
    ‚Ä¢ Order processing
    ‚Ä¢ FEFO reservation
    ‚Ä¢ Payment capture
    Events:
    ‚Ä¢ OrderPlaced ‚Üí /checkout-orchestration
    ‚Ä¢ PaymentProcessed
    Workflows: 
    ‚Ä¢ /tax-orchestration
  end note
}


rectangle "üë• PRODUCT & CUSTOMER MANAGEMENT" as ProductCustomerMgmt {
  [Product Catalog] as ProductCatalog <<Supporting>>
    note right of ProductCatalog
        ‚Ä¢ Product data
        ‚Ä¢ Shelf life specs
        ‚Ä¢ Import details
        ‚Ä¢ Nutrition info
        ‚Ä¢ Compliance
        ‚Ä¢ Certifications
    end note

    [Customer Management] as CustomerMgmt <<Supporting>>
    note right of CustomerMgmt
        ‚Ä¢ Customer profiles
        ‚Ä¢ Preferences
        ‚Ä¢ Order history
        ‚Ä¢ B2B relations
        ‚Ä¢ Credit terms
        ‚Ä¢ Loyalty programs
    end note

    [Payment & Billing] as PaymentBilling <<Supporting>>
    note right of PaymentBilling
        ‚Ä¢ Payment processing
        ‚Ä¢ Invoice generation
        ‚Ä¢ Credit management
        ‚Ä¢ Financial records
        ‚Ä¢ Tax calculations
        ‚Ä¢ Accounting integration
    end note

    [Sales & Quoting] as SalesQuoting <<Supporting>>
    note right of SalesQuoting
        ‚Ä¢ B2B quotes
        ‚Ä¢ Volume pricing
        ‚Ä¢ Contract terms
        ‚Ä¢ Bulk orders
        ‚Ä¢ Custom pricing
        ‚Ä¢ Tender management
    end note

    [Returns Management] as ReturnsMgmt <<Supporting>>
    note right of ReturnsMgmt
        ‚Ä¢ Return processing
        ‚Ä¢ Quality inspection
        ‚Ä¢ Refund/credit
        ‚Ä¢ Restocking
        ‚Ä¢ Damage claims
        ‚Ä¢ RMA tracking
    end note
    
    [Subscriptions] as Subscriptions <<Strategic>>
    note right of Subscriptions
        ‚Ä¢ Recurring orders
        ‚Ä¢ Subscription plans
        ‚Ä¢ Billing cycles
        ‚Ä¢ Auto-renewal
        ‚Ä¢ Pause/resume
        ‚Ä¢ Customer retention
    end note
    
    [Reviews & Ratings] as Reviews <<Supporting>>
    note right of Reviews
        ‚Ä¢ Product reviews
        ‚Ä¢ Customer ratings
        ‚Ä¢ Moderation
        ‚Ä¢ Feedback analysis
        ‚Ä¢ Review responses
        ‚Ä¢ Quality metrics
    end note
    
    [Marketing] as Marketing <<Strategic>>
    note right of Marketing
        ‚Ä¢ Campaign management
        ‚Ä¢ Promotions
        ‚Ä¢ Customer segmentation
        ‚Ä¢ Email marketing
        ‚Ä¢ Loyalty programs
        ‚Ä¢ Analytics integration
    end note
}


rectangle "üè≠ CORE OPERATIONS & INVENTORY" as CoreOperations {
  [Inventory & Shelf-Life] as InventoryShelfLife <<Core>>
    note right of InventoryShelfLife
        ‚Ä¢ FEFO management
        ‚Ä¢ Expiry tracking
        ‚Ä¢ Stock levels
        ‚Ä¢ Location mapping
        ‚Ä¢ Waste reduction
        ‚Ä¢ Demand forecasting
    end note

    [Batch Tracking] as BatchTracking <<Core>>
    note right of BatchTracking
        ‚Ä¢ Lot numbers
        ‚Ä¢ Production dates
        ‚Ä¢ Expiry dates
        ‚Ä¢ Quality scores
        ‚Ä¢ Movement history
        ‚Ä¢ Chain of custody
    end note

    [Cold Chain Monitoring] as ColdChainMonitor <<Core>>
    note right of ColdChainMonitor
        ‚Ä¢ Temperature logs
        ‚Ä¢ Humidity control
        ‚Ä¢ Transport conditions
        ‚Ä¢ Breach detection
        ‚Ä¢ Equipment status
        ‚Ä¢ IoT integration
    end note

    [Pricing & Promotions] as PricingPromotions <<Core>>
    note right of PricingPromotions
        ‚Ä¢ Dynamic pricing
        ‚Ä¢ Markdown logic
        ‚Ä¢ Promotional rules
        ‚Ä¢ Market analysis
        ‚Ä¢ Cost optimization
        ‚Ä¢ Competitor tracking
    end note
}


rectangle "üì¶ FULFILLMENT & QUALITY ASSURANCE" as FulfillmentQuality {
  [Shipping & Fulfillment] as ShippingFulfillment <<Core>>
    note right of ShippingFulfillment
        ‚Ä¢ Order picking
        ‚Ä¢ Packing optimization
        ‚Ä¢ Carrier selection
        ‚Ä¢ Delivery tracking
        ‚Ä¢ Route optimization
        ‚Ä¢ Warehouse mgmt
    end note

    [Supplier & Traceability] as SupplierTrace <<Strategic>>
    note right of SupplierTrace
        ‚Ä¢ Supplier records
        ‚Ä¢ Origin tracking
        ‚Ä¢ Certification mgmt
        ‚Ä¢ Recall procedures
        ‚Ä¢ Compliance docs
        ‚Ä¢ Audit trails
    end note

    [Quality Control] as QualityControl <<Strategic>>
    note right of QualityControl
        ‚Ä¢ Incoming inspection
        ‚Ä¢ Quality standards
        ‚Ä¢ Testing protocols
        ‚Ä¢ Rejection handling
        ‚Ä¢ Compliance check
        ‚Ä¢ Lab integration
    end note

    [Analytics & Reporting] as AnalyticsReporting <<Strategic>>
    note right of AnalyticsReporting
        ‚Ä¢ Performance KPIs
        ‚Ä¢ Trend analysis
        ‚Ä¢ Demand forecasting
        ‚Ä¢ Loss prevention
        ‚Ä¢ ROI metrics
        ‚Ä¢ BI dashboards
    end note
}


rectangle "üîî SYSTEM SUPPORT & NOTIFICATIONS" as SystemSupport {
  [Notifications & Alerts] as NotificationsAlerts <<Supporting>>
    note right of NotificationsAlerts
        ‚Ä¢ Expiry warnings ‚Ä¢ Quality alerts ‚Ä¢ System notifications
        ‚Ä¢ Promotional msgs ‚Ä¢ Compliance alerts ‚Ä¢ Status updates
        ‚Ä¢ Multi-channel delivery ‚Ä¢ Alert escalation ‚Ä¢ Audit logs
    end note
}

' Integration Layer
rectangle "üîÑ INTEGRATION LAYER" as IntegrationLayer {
  [Event Bus] as EventBus <<Integration>>
    note right of EventBus
        ‚Ä¢ Apache Kafka
        ‚Ä¢ Publish/Subscribe
        ‚Ä¢ At-least-once delivery
        ‚Ä¢ Event sourcing
    end note
    
  [API Gateway] as APIGateway <<Integration>>
    note right of APIGateway
        ‚Ä¢ REST & GraphQL APIs
        ‚Ä¢ Authentication
        ‚Ä¢ Rate limiting
        ‚Ä¢ Request routing
    end note
    
  [Admin BFF] as AdminBFF <<Integration>>
    note right of AdminBFF
        ‚Ä¢ Administrative UI backend
        ‚Ä¢ Cross-context data aggregation
        ‚Ä¢ Unified admin API surface
        ‚Ä¢ Audit logging
    end note
    
  [Anti-Corruption Layer] as ACL <<Integration>>
    note right of ACL
        ‚Ä¢ External system adapters
        ‚Ä¢ Data translation
        ‚Ä¢ Protocol conversion
        ‚Ä¢ Model isolation
    end note
}

' External Systems
rectangle "üåê EXTERNAL SYSTEMS" as ExternalSystems {
  ' Payment & Financial
  [Stripe] as Stripe <<External>>
  note right of Stripe
    ‚Ä¢ Payment processing
    ‚Ä¢ Subscription billing
    ‚Ä¢ Card management
  end note
  
  ' ERP & Operations
  [Odoo ERP] as Odoo <<External>>
  note right of Odoo
    ‚Ä¢ Inventory management
    ‚Ä¢ Order processing
    ‚Ä¢ Supply chain
  end note
  
  ' CRM & Marketing
  [HubSpot] as HubSpot <<External>>
  note right of HubSpot
    ‚Ä¢ Customer relationship
    ‚Ä¢ Marketing automation
    ‚Ä¢ Sales pipeline
  end note
  
  ' Logistics
  [Shipping Carriers] as ShippingCarriers <<External>>
  note right of ShippingCarriers
    ‚Ä¢ FedEx
    ‚Ä¢ UPS
    ‚Ä¢ DHL
    ‚Ä¢ Local couriers
  end note
  
  ' EDI & B2B
  [Supplier EDI] as SupplierEDI <<External>>
  note right of SupplierEDI
    ‚Ä¢ Supplier integration
    ‚Ä¢ Purchase orders
    ‚Ä¢ ASN processing
  end note
  
  ' Analytics
  [Google Analytics] as GoogleAnalytics <<External>>
  [Tableau] as Tableau <<External>>
  
  ' Compliance
  [Compliance Services] as ComplianceServices <<External>>
  note right of ComplianceServices
    ‚Ä¢ Food safety
    ‚Ä¢ Import/export
    ‚Ä¢ Certifications
  end note
  
  [Payment Gateway] as Payment <<External>>
  [Warehouse System] as Warehouse <<External>>
  
  ' Within Customer Interface Layer
  ShoppingCart --> OrderMgmt : add to cart

  ' Within Product & Customer Management
  ProductCatalog --> CustomerMgmt
  CustomerMgmt --> PaymentBilling
  PaymentBilling --> SalesQuoting
  SalesQuoting --> ReturnsMgmt
  CustomerMgmt --> Subscriptions : manages
  CustomerMgmt --> Reviews : provides
  CustomerMgmt --> Marketing : segments
  ProductCatalog --> Reviews : receives
  ProductCatalog --> Marketing : features
  Subscriptions --> PaymentBilling : recurring payments
  Marketing --> ProductCatalog : promotes
  Marketing --> CustomerMgmt : targets

  ' Within Core Operations
  InventoryShelfLife --> BatchTracking
  BatchTracking --> ColdChainMonitor
  ColdChainMonitor --> PricingPromotions
  PricingPromotions --> InventoryShelfLife : feedback loop

  ' Within Fulfillment & Quality
  ShippingFulfillment --> SupplierTrace
  SupplierTrace --> QualityControl
  QualityControl --> AnalyticsReporting
  AnalyticsReporting --> ShippingFulfillment : feedback loop

  ' Cross-layer connections
  ShoppingCart --> ProductCatalog : availability
  ShoppingCart --> CustomerMgmt : customer data
  ShoppingCart --> Subscriptions : subscription options
  ShoppingCart --> Reviews : product ratings
  OrderMgmt --> PaymentBilling : payment
  ShoppingCart --> InventoryShelfLife : stock check
  ShoppingCart --> PricingPromotions : pricing
  OrderMgmt --> InventoryShelfLife : reserve FEFO
  OrderMgmt --> PricingPromotions : pricing
  OrderMgmt --> ShippingFulfillment : fulfill

  ProductCatalog --> InventoryShelfLife : shelf life
  ProductCatalog --> PricingPromotions : product data
  SalesQuoting --> PricingPromotions : bulk pricing
  SalesQuoting --> InventoryShelfLife : volume check
  ReturnsMgmt --> InventoryShelfLife : return stock
  ReturnsMgmt --> QualityControl : quality check
  PaymentBilling --> AnalyticsReporting : financial data

  InventoryShelfLife --> ShippingFulfillment : pick lists
  InventoryShelfLife --> SupplierTrace : traceability
  InventoryShelfLife --> QualityControl : QC trigger
  InventoryShelfLife --> AnalyticsReporting : inventory KPIs
  BatchTracking --> SupplierTrace : batch info
  ColdChainMonitor --> ShippingFulfillment : cold chain
  PricingPromotions --> AnalyticsReporting : pricing KPIs

  ' To Notifications
  InventoryShelfLife --> NotificationsAlerts : expiry alerts
  ColdChainMonitor --> NotificationsAlerts : breach alerts
  PricingPromotions --> NotificationsAlerts : promotion alerts
  QualityControl --> NotificationsAlerts : quality alerts
  AnalyticsReporting --> NotificationsAlerts : system alerts
  ReturnsMgmt --> NotificationsAlerts : return alerts
  Subscriptions --> NotificationsAlerts : renewal alerts
  Marketing --> NotificationsAlerts : campaign alerts

  ' From Notifications
  NotificationsAlerts --> CustomerMgmt : customer alerts
  NotificationsAlerts --> OrderMgmt : system alerts

  ' Integration Layer connections
  AdminBFF --> OrderMgmt : admin operations
  AdminBFF --> CustomerMgmt : admin operations
  AdminBFF --> ProductCatalog : admin operations

  ' Event Bus connections
  OrderMgmt --> EventBus : publishes Order*
  EventBus --> PaymentBilling : subscribes to Order*
  EventBus --> ShippingFulfillment : subscribes to Order*
  EventBus --> InventoryShelfLife : subscribes to Order*

  ' API Gateway connections
  APIGateway --> ShoppingCart : serves UI
  APIGateway --> OrderMgmt : processes orders
  APIGateway --> CustomerMgmt : manages customers

  ' External system connections
  PaymentBilling --> Stripe : processes payments
  Subscriptions --> Stripe : manages subscriptions
  OrderMgmt --> Odoo : syncs orders
  InventoryShelfLife --> Odoo : updates stock
  CustomerMgmt --> HubSpot : syncs customer data
  Marketing --> HubSpot : manages campaigns
  ShippingFulfillment --> ShippingCarriers : schedules shipments
  SupplierTrace --> SupplierEDI : exchanges EDI docs
  AnalyticsReporting --> GoogleAnalytics : tracks usage
  AnalyticsReporting --> Tableau : visualizes data
  QualityControl --> ComplianceServices : verifies compliance
  AdminBFF --> Odoo : manages operations
  AdminBFF --> HubSpot : manages CRM
  
  ' Enhanced Integration Points
  OrderMgmt --> Payment : [ACL]\nProcess Payment
  OrderMgmt --> Warehouse : [OHS]\nReserve Inventory

@enduml
